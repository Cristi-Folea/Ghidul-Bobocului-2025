---
import Layout from "../layouts/Layout.astro";

const questions = [
  {
    text: "Ce culoare te reprezintÄƒ cel mai bine?",
    options: ["Roz", "Negru/Mov", "Alb/Pastel", "Galben", "Verde", "Albastru"],
  },
  {
    text: "Ce fel de activitate te atrage cel mai mult?",
    options: [
      "GÄƒtit sau relaxare",
      "Petrecere sau o notÄƒ de rebeliune",
      "ExploraÈ›ie Ã®n nori sau visare",
      "Somn È™i confort",
      "Aventura È™i energia",
      "È˜mecherie sarcasticÄƒ",
    ],
  },
  {
    text: "Care mediu te inspirÄƒ cel mai mult?",
    options: [
      "CasÄƒ primitoare",
      "OraÈ™ punk/gotic",
      "Cer È™i nori",
      "Pat cocon",
      "PÃ¢rÃ¢u/iazul vesel",
      "Cartier cu umor",
    ],
  },
  {
    text: "Ce trÄƒsÄƒturÄƒ te defineÈ™te?",
    options: [
      "BlÃ¢ndeÈ›e",
      "Rebel fÄƒrÄƒ cauzÄƒ",
      "Subtil È™i visÄƒtor",
      "Calm È™i cozy",
      "Energetic È™i optimist",
      "Sarcastic È™i amuzant",
    ],
  },
  {
    text: "Ce prieten È›i-ar plÄƒcea sÄƒ-È›i fie?",
    options: [
      "ÃÈ›i gÄƒteÈ™te prÄƒjituri",
      "Te provoacÄƒ cu umor",
      "Te poartÄƒ peste nori",
      "ÃÈ›i oferÄƒ confort",
      "Te Ã®ncurajeazÄƒ sÄƒ sari",
      "Te ia peste picior cu glume",
    ],
  },
];

// Sistem de scoruri pentru fiecare tip de personalitate
const personalityScores = {
  "Hello Kitty": {
    // ÃNTREBAREA 1 - Culoare
    Roz: 3,
    "Negru/Mov": 1,
    "Alb/Pastel": 2,
    Galben: 2,
    Verde: 2,
    Albastru: 1,

    // ÃNTREBAREA 2 - Activitate
    "GÄƒtit sau relaxare": 3,
    "Petrecere sau o notÄƒ de rebeliune": 1,
    "ExploraÈ›ie Ã®n nori sau visare": 2,
    "Somn È™i confort": 2,
    "Aventura È™i energia": 2,
    "È˜mecherie sarcasticÄƒ": 1,

    // ÃNTREBAREA 3 - Mediu
    "CasÄƒ primitoare": 3,
    "OraÈ™ punk/gotic": 1,
    "Cer È™i nori": 2,
    "Pat cocon": 2,
    "PÃ¢rÃ¢u/iazul vesel": 2,
    "Cartier cu umor": 1,

    // ÃNTREBAREA 4 - TrÄƒsÄƒturÄƒ
    BlÃ¢ndeÈ›e: 3,
    "Rebel fÄƒrÄƒ cauzÄƒ": 1,
    "Subtil È™i visÄƒtor": 2,
    "Calm È™i cozy": 2,
    "Energetic È™i optimist": 2,
    "Sarcastic È™i amuzant": 1,

    // ÃNTREBAREA 5 - Prieten
    "ÃÈ›i gÄƒteÈ™te prÄƒjituri": 3,
    "Te provoacÄƒ cu umor": 1,
    "Te poartÄƒ peste nori": 2,
    "ÃÈ›i oferÄƒ confort": 2,
    "Te Ã®ncurajeazÄƒ sÄƒ sari": 2,
    "Te ia peste picior cu glume": 1,
  },

  Kuromi: {
    // ÃNTREBAREA 1 - Culoare
    Roz: 1,
    "Negru/Mov": 3,
    "Alb/Pastel": 1,
    Galben: 1,
    Verde: 1,
    Albastru: 2,

    // ÃNTREBAREA 2 - Activitate
    "GÄƒtit sau relaxare": 1,
    "Petrecere sau o notÄƒ de rebeliune": 3,
    "ExploraÈ›ie Ã®n nori sau visare": 1,
    "Somn È™i confort": 1,
    "Aventura È™i energia": 2,
    "È˜mecherie sarcasticÄƒ": 2,

    // ÃNTREBAREA 3 - Mediu
    "CasÄƒ primitoare": 1,
    "OraÈ™ punk/gotic": 3,
    "Cer È™i nori": 1,
    "Pat cocon": 1,
    "PÃ¢rÃ¢u/iazul vesel": 1,
    "Cartier cu umor": 2,

    // ÃNTREBAREA 4 - TrÄƒsÄƒturÄƒ
    BlÃ¢ndeÈ›e: 1,
    "Rebel fÄƒrÄƒ cauzÄƒ": 3,
    "Subtil È™i visÄƒtor": 1,
    "Calm È™i cozy": 1,
    "Energetic È™i optimist": 2,
    "Sarcastic È™i amuzant": 2,

    // ÃNTREBAREA 5 - Prieten
    "ÃÈ›i gÄƒteÈ™te prÄƒjituri": 1,
    "Te provoacÄƒ cu umor": 3,
    "Te poartÄƒ peste nori": 1,
    "ÃÈ›i oferÄƒ confort": 1,
    "Te Ã®ncurajeazÄƒ sÄƒ sari": 2,
    "Te ia peste picior cu glume": 2,
  },

  Cinnamoroll: {
    // ÃNTREBAREA 1 - Culoare
    Roz: 2,
    "Negru/Mov": 1,
    "Alb/Pastel": 3,
    Galben: 2,
    Verde: 2,
    Albastru: 2,

    // ÃNTREBAREA 2 - Activitate
    "GÄƒtit sau relaxare": 2,
    "Petrecere sau o notÄƒ de rebeliune": 1,
    "ExploraÈ›ie Ã®n nori sau visare": 3,
    "Somn È™i confort": 2,
    "Aventura È™i energia": 2,
    "È˜mecherie sarcasticÄƒ": 1,

    // ÃNTREBAREA 3 - Mediu
    "CasÄƒ primitoare": 2,
    "OraÈ™ punk/gotic": 1,
    "Cer È™i nori": 3,
    "Pat cocon": 2,
    "PÃ¢rÃ¢u/iazul vesel": 2,
    "Cartier cu umor": 1,

    // ÃNTREBAREA 4 - TrÄƒsÄƒturÄƒ
    BlÃ¢ndeÈ›e: 2,
    "Rebel fÄƒrÄƒ cauzÄƒ": 1,
    "Subtil È™i visÄƒtor": 3,
    "Calm È™i cozy": 2,
    "Energetic È™i optimist": 2,
    "Sarcastic È™i amuzant": 1,

    // ÃNTREBAREA 5 - Prieten
    "ÃÈ›i gÄƒteÈ™te prÄƒjituri": 2,
    "Te provoacÄƒ cu umor": 1,
    "Te poartÄƒ peste nori": 3,
    "ÃÈ›i oferÄƒ confort": 2,
    "Te Ã®ncurajeazÄƒ sÄƒ sari": 2,
    "Te ia peste picior cu glume": 1,
  },

  Pompompurin: {
    // ÃNTREBAREA 1 - Culoare
    Roz: 1,
    "Negru/Mov": 1,
    "Alb/Pastel": 2,
    Galben: 3,
    Verde: 2,
    Albastru: 1,

    // ÃNTREBAREA 2 - Activitate
    "GÄƒtit sau relaxare": 2,
    "Petrecere sau o notÄƒ de rebeliune": 1,
    "ExploraÈ›ie Ã®n nori sau visare": 2,
    "Somn È™i confort": 3,
    "Aventura È™i energia": 1,
    "È˜mecherie sarcasticÄƒ": 1,

    // ÃNTREBAREA 3 - Mediu
    "CasÄƒ primitoare": 2,
    "OraÈ™ punk/gotic": 1,
    "Cer È™i nori": 2,
    "Pat cocon": 3,
    "PÃ¢rÃ¢u/iazul vesel": 1,
    "Cartier cu umor": 1,

    // ÃNTREBAREA 4 - TrÄƒsÄƒturÄƒ
    BlÃ¢ndeÈ›e: 2,
    "Rebel fÄƒrÄƒ cauzÄƒ": 1,
    "Subtil È™i visÄƒtor": 2,
    "Calm È™i cozy": 3,
    "Energetic È™i optimist": 1,
    "Sarcastic È™i amuzant": 1,

    // ÃNTREBAREA 5 - Prieten
    "ÃÈ›i gÄƒteÈ™te prÄƒjituri": 2,
    "Te provoacÄƒ cu umor": 1,
    "Te poartÄƒ peste nori": 2,
    "ÃÈ›i oferÄƒ confort": 3,
    "Te Ã®ncurajeazÄƒ sÄƒ sari": 1,
    "Te ia peste picior cu glume": 1,
  },

  Keroppi: {
    // ÃNTREBAREA 1 - Culoare
    Roz: 1,
    "Negru/Mov": 1,
    "Alb/Pastel": 2,
    Galben: 2,
    Verde: 3,
    Albastru: 2,

    // ÃNTREBAREA 2 - Activitate
    "GÄƒtit sau relaxare": 1,
    "Petrecere sau o notÄƒ de rebeliune": 2,
    "ExploraÈ›ie Ã®n nori sau visare": 2,
    "Somn È™i confort": 1,
    "Aventura È™i energia": 3,
    "È˜mecherie sarcasticÄƒ": 1,

    // ÃNTREBAREA 3 - Mediu
    "CasÄƒ primitoare": 1,
    "OraÈ™ punk/gotic": 1,
    "Cer È™i nori": 2,
    "Pat cocon": 1,
    "PÃ¢rÃ¢u/iazul vesel": 3,
    "Cartier cu umor": 2,

    // ÃNTREBAREA 4 - TrÄƒsÄƒturÄƒ
    BlÃ¢ndeÈ›e: 2,
    "Rebel fÄƒrÄƒ cauzÄƒ": 1,
    "Subtil È™i visÄƒtor": 2,
    "Calm È™i cozy": 1,
    "Energetic È™i optimist": 3,
    "Sarcastic È™i amuzant": 1,

    // ÃNTREBAREA 5 - Prieten
    "ÃÈ›i gÄƒteÈ™te prÄƒjituri": 1,
    "Te provoacÄƒ cu umor": 2,
    "Te poartÄƒ peste nori": 2,
    "ÃÈ›i oferÄƒ confort": 1,
    "Te Ã®ncurajeazÄƒ sÄƒ sari": 3,
    "Te ia peste picior cu glume": 1,
  },

  "Badtz-Maru": {
    // ÃNTREBAREA 1 - Culoare
    Roz: 1,
    "Negru/Mov": 2,
    "Alb/Pastel": 1,
    Galben: 1,
    Verde: 1,
    Albastru: 3,

    // ÃNTREBAREA 2 - Activitate
    "GÄƒtit sau relaxare": 1,
    "Petrecere sau o notÄƒ de rebeliune": 2,
    "ExploraÈ›ie Ã®n nori sau visare": 1,
    "Somn È™i confort": 1,
    "Aventura È™i energia": 2,
    "È˜mecherie sarcasticÄƒ": 3,

    // ÃNTREBAREA 3 - Mediu
    "CasÄƒ primitoare": 1,
    "OraÈ™ punk/gotic": 2,
    "Cer È™i nori": 1,
    "Pat cocon": 1,
    "PÃ¢rÃ¢u/iazul vesel": 2,
    "Cartier cu umor": 3,

    // ÃNTREBAREA 4 - TrÄƒsÄƒturÄƒ
    BlÃ¢ndeÈ›e: 1,
    "Rebel fÄƒrÄƒ cauzÄƒ": 2,
    "Subtil È™i visÄƒtor": 1,
    "Calm È™i cozy": 1,
    "Energetic È™i optimist": 2,
    "Sarcastic È™i amuzant": 3,

    // ÃNTREBAREA 5 - Prieten
    "ÃÈ›i gÄƒteÈ™te prÄƒjituri": 1,
    "Te provoacÄƒ cu umor": 2,
    "Te poartÄƒ peste nori": 1,
    "ÃÈ›i oferÄƒ confort": 1,
    "Te Ã®ncurajeazÄƒ sÄƒ sari": 2,
    "Te ia peste picior cu glume": 3,
  },
};

const results = {
  "Hello Kitty": {
    title: "Hello Kitty ğŸŒ¸",
    description: "EÈ™ti prietenoasÄƒ, caldÄƒ È™i mereu gata sÄƒ ajuÈ›i pe ceilalÈ›i.",
  },
  Kuromi: {
    title: "Kuromi ğŸ–¤",
    description: "Ai un spirit rebel È™i Ã®È›i place sÄƒ fii diferit!",
  },
  Cinnamoroll: {
    title: "Cinnamoroll â˜ï¸",
    description: "EÈ™ti visÄƒtor È™i Ã®È›i place sÄƒ trÄƒieÈ™ti printre nori.",
  },
  Pompompurin: {
    title: "Pompompurin ğŸ®",
    description: "IubeÈ™ti confortul È™i momentele cozy.",
  },
  Keroppi: {
    title: "Keroppi ğŸ¸",
    description: "Optimist È™i plin de energie, aduci veselie Ã®n jurul tÄƒu.",
  },
  "Badtz-Maru": {
    title: "Badtz-Maru ğŸ§",
    description: "Sarcastic È™i amuzant, ai mereu o replicÄƒ pregÄƒtitÄƒ.",
  },
};
---

<Layout>
  <div class="quiz-container">
    <div class="progress-bar">
      <div class="progress-fill" id="progress"></div>
    </div>
    <div class="question" id="question"></div>
    <div class="options" id="options"></div>
    <div class="result" id="result" style="display: none;">
      <div class="result-title" id="result-title"></div>
      <div class="result-description" id="result-description"></div>
      <button onclick="restartQuiz()" class="restart-btn"
        >ÃncearcÄƒ din nou</button
      >
    </div>
  </div>
</Layout>

<style>
  .quiz-container {
    font-family: var(--font-h1);

    /* background: linear-gradient(135deg, #ffb6c1, #ffc0cb); */
    background-color: rgb(223 163 179);
    background-image: url(../../public/media/elemente/noise-tile-dark.svg);
    padding: 2rem;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    max-width: 800px;
    text-align: center;
    margin: 2rem auto;
    position: relative;
  }

  .progress-bar {
    background: rgb(255, 255, 255);
    height: 12px;
    border-radius: 6px;
    margin-bottom: 2rem;
    overflow: hidden;
    border: 2px solid rgba(255, 255, 255, 0.9);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .progress-fill {
    background: linear-gradient(
      90deg,
      hsl(211, 100%, 54%),
      hsl(211, 100%, 86%)
    );
    height: 100%;
    transition: width 0.5s ease;
    border-radius: 4px;
    /* box-shadow: 0 2px 8px rgba(255, 20, 147, 0.3); */
  }

  .question {
    font-size: 1.7rem;
    font-weight: bold;
    margin-bottom: 2rem;
    color: #fff;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  }

  #options {
    margin: 1rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: 0.8rem;

    button {
      display: flex;
      align-items: center;
      justify-content: center;

      background: rgb(58 92 128);
      width: 10em;
      height: 7em;
      color: white;

      border: none;
      padding: 0.8rem 2rem;
      border-radius: 25px;
      cursor: pointer;

      font-size: 0.9rem;
      font-weight: bold;
      text-align: center;
      transition: all 0.3s ease-in-out;
    }

    button:hover {
      background: #ff1493;
      transform: translateY(-2px);
    }
  }

  .result {
    background: rgba(255, 255, 255, 0.95);
    padding: 2rem;
    border-radius: 15px;
    margin-top: 1rem;
  }

  .result-title {
    font-size: 1.8rem;
    font-weight: bold;
    margin-bottom: 1rem;
    color: #ff69b4;
  }

  .result-description {
    font-size: 1.1rem;
    margin-bottom: 2rem;
    color: #666;
    line-height: 1.5;
  }

  .restart-btn {
    background: #ff69b4;
    color: white;
    border: none;
    padding: 0.8rem 2rem;
    border-radius: 25px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: bold;
    transition: all 0.3s;
  }

  .restart-btn:hover {
    background: #ff1493;
    transform: translateY(-2px);
  }
</style>

<script is:inline define:vars={{ questions, personalityScores, results }}>
  document.addEventListener("astro:page-load", () => {
    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const resultEl = document.getElementById("result");
    const resultTitleEl = document.getElementById("result-title");
    const resultDescriptionEl = document.getElementById("result-description");
    const progressEl = document.getElementById("progress");

    let currentQuestion = 0;
    const answers = [];

    function updateProgress() {
      const percentage = (currentQuestion / questions.length) * 100;
      progressEl.style.width = percentage + "%";
    }

    function showQuestion() {
      if (currentQuestion >= questions.length) {
        showResult();
        return;
      }

      updateProgress();
      const q = questions[currentQuestion];
      questionEl.textContent = `${currentQuestion + 1}. ${q.text}`;

      optionsEl.innerHTML = "";
      q.options.forEach((opt) => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => {
          answers.push(opt);
          currentQuestion++;
          showQuestion();
        };
        optionsEl.appendChild(btn);
      });
    }

    function showResult() {
      // CalculeazÄƒ scorurile pentru fiecare personalitate
      const scores = {};
      for (const personality in personalityScores) {
        scores[personality] = 0;
        answers.forEach((answer) => {
          const score = personalityScores[personality][answer];
          if (score !== undefined) {
            scores[personality] += score;
          } else {
            console.warn(`Missing score for ${personality} - ${answer}`);
          }
        });
      }

      // GÄƒseÈ™te personalitatea cu cel mai mare scor
      let maxScore = 0;
      let winningPersonality = "Hello Kitty";
      for (const personality in scores) {
        if (scores[personality] > maxScore) {
          maxScore = scores[personality];
          winningPersonality = personality;
        }
      }

      // AfiÈ™eazÄƒ rezultatul
      const result = results[winningPersonality];
      resultTitleEl.textContent = result.title;
      resultDescriptionEl.textContent = result.description;

      // Ascunde Ã®ntrebÄƒrile È™i afiÈ™eazÄƒ rezultatul
      questionEl.style.display = "none";
      optionsEl.style.display = "none";
      resultEl.style.display = "block";
      progressEl.style.width = "100%";

      console.log("RÄƒspunsuri:", answers);
      console.log("Scoruri:", scores);
      console.log("CÃ¢È™tigÄƒtor:", winningPersonality);
    }

    function restartQuiz() {
      currentQuestion = 0;
      answers.length = 0;
      questionEl.style.display = "block";
      optionsEl.style.display = "flex";
      resultEl.style.display = "none";
      showQuestion();
    }

    // Expune funcÈ›ia global pentru butonul de restart
    window.restartQuiz = restartQuiz;

    showQuestion();
  });
</script>
